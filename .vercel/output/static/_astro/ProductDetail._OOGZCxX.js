import{j as e}from"./jsx-runtime.D3GSbgeI.js";import{r as l}from"./index.bmQhMlF6.js";import{g as D}from"./supabaseClient.DQBRCACc.js";import{r as P,f as T}from"./currency.DLCe802R.js";import{addItemToCart as V}from"./cart.BBzTRO1A.js";import"./index.yBjzXJbu.js";import"./index.FHxf1fDt.js";function H({variantId:a,prices:i,className:r=""}){const x=P(),p=(i||[]).find(g=>g.currency===x)?.unit_amount_cents||0;return e.jsx("button",{className:`btn ${r}`,onClick:async()=>{await V(a,p,1),location.href="/cart"},children:"Add to Shopping Bag"})}function L({handle:a,id:i}){console.log("*** [ProductDetail TEST] Component is mounting with params:",{handle:a,id:i});const[r,x]=l.useState(null),[p,g]=l.useState([]),[y,j]=l.useState(""),[d,v]=l.useState(null),[w,C]=l.useState([]),[N,z]=l.useState("GBP"),[B,f]=l.useState(!1),[_,I]=l.useState(null);return l.useEffect(()=>{z(P()),(async()=>{const t=D();if(!t){f(!0);return}if(!a&&!i){f(!0);return}const o={envUrl:"https://apkohkqyebipmzvdwxgr.supabase.co",input:{handle:a,id:i}};try{console.debug("[ProductDetail] init",o)}catch{}let s=null;if(i){console.log("[ProductDetail] Fetching by ID:",i);const{data:n,error:c}=await t.from("products").select("id,title,handle,description,price_gbp,price_eur,product_details,materials_care").eq("id",i).maybeSingle();o.byId={ok:!!n,error:c?.message},console.debug("[ProductDetail] By ID Result:",{data:n,error:c}),s=n}if(!s&&a){console.log("[ProductDetail] Fetching by Handle:",a);const{data:n,error:c}=await t.from("products").select("id,title,handle,description,price_gbp,price_eur,product_details,materials_care").eq("handle",a).maybeSingle();o.byHandle={ok:!!n,error:c?.message},console.debug("[ProductDetail] By Handle Result:",{data:n,error:c}),s=n}if(!s){console.log("[ProductDetail] Product not found. Debug info:",o),I(o),f(!0),x(null);return}if(x(s),s){const{data:n}=await t.from("product_images").select("url").eq("product_id",s.id).order("position"),c=(n||[]).map(u=>u.url);g(c),j(c[0]||"");const{data:q}=await t.from("product_variants").select("id,sku").eq("product_id",s.id),b={};for(const u of q||[]){const{data:E}=await t.from("product_variant_options").select("name,value").eq("variant_id",u.id),k=(E||[]).find(F=>F.name==="Size");k&&(b[k.value]=u.id)}const S=Object.keys(b).sort();C(S);const A=S[0],h=b[A];if(h){const{data:u}=await t.from("prices").select("currency,unit_amount_cents").eq("variant_id",h);v({id:h,sku:"",prices:u||[],optionsByVariant:b})}}})()},[a,i]),B?e.jsxs("div",{children:[e.jsx("div",{children:"Product not found."}),_&&e.jsx("pre",{style:{marginTop:12,fontSize:12,background:"#f6f6f6",padding:12,borderRadius:6,overflow:"auto"},children:JSON.stringify(_,null,2)})]}):r?e.jsxs("div",{className:"flex flex-col md:flex-row gap-12 lg:gap-16 min-h-screen py-8 px-6 md:px-12 lg:px-16 max-w-[1800px] mx-auto items-start md:items-center",children:[e.jsx("div",{className:"w-full md:w-[45%] lg:w-[48%] flex justify-center",children:e.jsx("div",{className:"backdrop-blur-md bg-white/5 border border-white/20 rounded-2xl shadow-[0_8px_32px_0_rgba(0,0,0,0.08)] p-6 md:p-8 w-full max-w-[600px]",children:p.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"relative w-full aspect-[3/4] rounded-xl overflow-hidden mb-4",children:e.jsx("img",{src:y,alt:r.title,className:"w-full h-full object-contain transition-opacity duration-500"})}),e.jsx("div",{className:"flex gap-3 justify-center flex-wrap",children:p.map(t=>e.jsx("button",{onClick:()=>j(t),className:`w-14 h-14 rounded-lg overflow-hidden transition-all duration-300 ${t===y?"ring-2 ring-black/60 scale-105 opacity-100":"opacity-40 hover:opacity-80 hover:scale-105"}`,children:e.jsx("img",{src:t,alt:"Thumbnail",className:"w-full h-full object-cover"})},t))})]}):e.jsx("div",{className:"relative w-full aspect-[3/4] rounded-xl overflow-hidden",children:e.jsx("img",{src:"https://placehold.co/800x1000",alt:r.title,className:"w-full h-full object-contain"})})})}),e.jsx("div",{className:"w-full md:w-[55%] lg:w-[52%] flex justify-center md:py-8",children:e.jsx("div",{className:"backdrop-blur-md bg-white/5 border border-white/20 rounded-2xl shadow-[0_8px_32px_0_rgba(0,0,0,0.08)] p-8 md:p-10 lg:p-12 w-full max-w-[650px]",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-serif font-light tracking-tight text-[rgb(38,19,21)]",children:r.title}),d&&e.jsx("div",{className:"text-2xl md:text-3xl font-light text-[rgb(38,19,21)]",children:T(d.prices?.find(t=>t.currency===N)?.unit_amount_cents??0,N)}),e.jsx("div",{className:"border-t border-[rgb(38,19,21)]/10 my-6"}),w.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs uppercase tracking-wider text-[rgb(38,19,21)]/60 mb-3 font-medium",children:"Select Size"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(t=>e.jsx("button",{className:"px-6 py-2.5 rounded-full border border-[rgb(38,19,21)]/20 hover:border-[rgb(38,19,21)] hover:bg-[rgb(38,19,21)]/5 transition-all duration-300 text-sm font-medium text-[rgb(38,19,21)]",onClick:async()=>{const m=D(),o=(d?.optionsByVariant||{})[t];if(m&&o){const{data:s}=await m.from("prices").select("currency,unit_amount_cents").eq("variant_id",o);v({id:o,prices:s||[],optionsByVariant:d?.optionsByVariant})}},children:t},t))})]}),d&&e.jsx(H,{variantId:d.id,prices:d.prices||[],className:"w-full bg-[rgb(38,19,21)] text-white py-4 rounded-full font-medium text-base tracking-wide hover:bg-[rgb(38,19,21)]/90 transition-all duration-300 shadow-lg hover:shadow-xl"}),e.jsx("p",{className:"text-xs text-[rgb(38,19,21)]/60 text-center",children:"Complimentary shipping • Delivery in 4-11 weeks"}),e.jsx("div",{className:"border-t border-[rgb(38,19,21)]/10 my-6"}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-base leading-relaxed text-[rgb(38,19,21)]/80",children:r.description})}),e.jsx("div",{className:"border-t border-[rgb(38,19,21)]/10 my-6"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("details",{className:"group border-b border-[rgb(38,19,21)]/10 pb-3",children:[e.jsxs("summary",{className:"text-sm font-medium cursor-pointer flex justify-between items-center text-[rgb(38,19,21)] hover:text-[rgb(38,19,21)]/70 transition-colors",children:["In-store services",e.jsx("span",{className:"group-open:rotate-180 transition-transform duration-300 text-xs",children:"▾"})]}),e.jsx("p",{className:"text-sm mt-3 text-[rgb(38,19,21)]/70 leading-relaxed",children:"Complimentary services available in select stores."})]}),e.jsxs("details",{className:"group border-b border-[rgb(38,19,21)]/10 pb-3",children:[e.jsxs("summary",{className:"text-sm font-medium cursor-pointer flex justify-between items-center text-[rgb(38,19,21)] hover:text-[rgb(38,19,21)]/70 transition-colors",children:["Complimentary Delivery & Returns",e.jsx("span",{className:"group-open:rotate-180 transition-transform duration-300 text-xs",children:"▾"})]}),e.jsx("p",{className:"text-sm mt-3 text-[rgb(38,19,21)]/70 leading-relaxed",children:"Free delivery and returns on all orders."})]}),e.jsxs("details",{className:"group border-b border-[rgb(38,19,21)]/10 pb-3",children:[e.jsxs("summary",{className:"text-sm font-medium cursor-pointer flex justify-between items-center text-[rgb(38,19,21)] hover:text-[rgb(38,19,21)]/70 transition-colors",children:["Gifting",e.jsx("span",{className:"group-open:rotate-180 transition-transform duration-300 text-xs",children:"▾"})]}),e.jsx("p",{className:"text-sm mt-3 text-[rgb(38,19,21)]/70 leading-relaxed",children:"Complimentary gift wrapping available."})]}),Array.isArray(r.product_details)&&r.product_details.length>0&&e.jsxs("details",{className:"group border-b border-[rgb(38,19,21)]/10 pb-3",children:[e.jsxs("summary",{className:"text-sm font-medium cursor-pointer flex justify-between items-center text-[rgb(38,19,21)] hover:text-[rgb(38,19,21)]/70 transition-colors",children:["Product Details",e.jsx("span",{className:"group-open:rotate-180 transition-transform duration-300 text-xs",children:"▾"})]}),e.jsx("ul",{className:"list-disc ml-5 mt-3 text-sm text-[rgb(38,19,21)]/70 space-y-1",children:r.product_details.map((t,m)=>e.jsx("li",{children:t},m))})]}),Array.isArray(r.materials_care)&&r.materials_care.length>0&&e.jsxs("details",{className:"group border-b border-[rgb(38,19,21)]/10 pb-3",children:[e.jsxs("summary",{className:"text-sm font-medium cursor-pointer flex justify-between items-center text-[rgb(38,19,21)] hover:text-[rgb(38,19,21)]/70 transition-colors",children:["Materials & Care",e.jsx("span",{className:"group-open:rotate-180 transition-transform duration-300 text-xs",children:"▾"})]}),e.jsx("ul",{className:"list-disc ml-5 mt-3 text-sm text-[rgb(38,19,21)]/70 space-y-1",children:r.materials_care.map((t,m)=>e.jsx("li",{children:t},m))})]})]})]})})})]}):e.jsx("div",{children:"Loading…"})}export{L as default};
